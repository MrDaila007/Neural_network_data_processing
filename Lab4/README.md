# Лабораторная работа №4: Конкурентная нейронная сеть

## Цель работы

Изучение топологии и алгоритма функционирования конкурентной нейронной сети. Реализация программы для кластеризации и распознавания образов математических символов.

## Теоретические сведения

Конкурентная сеть — простейшая самоорганизующаяся сеть, обучающаяся **без учителя**. Способна к кластеризации входных данных.

### Архитектура сети

```
    Входной слой        Конкурентный слой
    (36 нейронов)       (5 нейронов)
    
    ┌───┐               ┌───┐
    │x₁ │──────────────►│ 1 │ → Кластер 1 (≤)
    └───┘               └───┘
    ┌───┐               ┌───┐
    │x₂ │──────────────►│ 2 │ → Кластер 2 (≥)
    └───┘               └───┘
      ⋮                   ⋮
    ┌───┐               ┌───┐
    │x₃₆│──────────────►│ 5 │ → Кластер 5 (≅)
    └───┘               └───┘
    
         Победитель: максимум скалярного произведения
```

### Основные формулы

**Выход нейрона:**
```
y_j = Σ w_ij × x_i = ||w_j|| × ||x|| × cos(α)
```

**Обновление весов победителя:**
```
w_ij := w_ij + β × (x_i - w_ij)
```

**Нормировка:**
```
w_ij := w_ij / ||w_j||
```

**Частотно-зависимый критерий:**
```
победитель = argmin_j (||x - w_j|| × (1 + f_j))
```

## Вариант задания

**Вариант 5:** Символы **≤**, **≥**, **≠**, **≈**, **≅** (размер 6×6)

## Требования

- Компилятор C++ с поддержкой C++17 (g++ 8+, clang++ 7+)
- Стандартная библиотека C++ (filesystem)

## Сборка и запуск

### 1. Компиляция

```bash
cd Lab4
g++ -std=c++17 solution.cpp -o solution
```

### 2. Запуск с выводом в консоль

```bash
./solution
```

### 3. Запуск с сохранением вывода в файл

```bash
# Сохранить вывод в файл (без отображения в консоли)
./solution > output.txt

# Сохранить вывод в файл И отобразить в консоли
./solution | tee output.txt

# Сохранить вывод вместе с ошибками
./solution > output.txt 2>&1
```

### 4. Компиляция отчёта LaTeX

```bash
xelatex report.tex
```

Требуется XeLaTeX и шрифты DejaVu.

## Структура файлов

```
Lab4/
├── README.md           # Этот файл
├── description.md      # Подробное описание задания
├── solution.cpp        # Исходный код решения
├── solution            # Скомпилированная программа
├── report.tex          # Отчет в формате LaTeX
├── report.pdf          # Скомпилированный отчет
├── output.txt          # Вывод программы (после запуска)
├── patterns/           # Эталонные образы
│   ├── LE.txt          # Символ ≤
│   ├── GE.txt          # Символ ≥
│   ├── NE.txt          # Символ ≠
│   ├── AP.txt          # Символ ≈
│   └── CO.txt          # Символ ≅
└── tests/              # Тестовые образы с шумом
    ├── LE/
    │   ├── noise_10/   # 10% шума
    │   ├── noise_20/   # 20% шума
    │   └── ...
    ├── GE/
    ├── NE/
    ├── AP/
    └── CO/
```

## Выходные файлы

После запуска программы создаются:

| Файл | Описание |
|------|----------|
| `tests/*/noise_*/test_*.txt` | Сгенерированные зашумлённые образы |
| `output.txt` | Полный вывод программы (при использовании `> output.txt`) |

## Пример вывода программы

```
========================================================
    ЛАБОРАТОРНАЯ РАБОТА №4: КОНКУРЕНТНАЯ СЕТЬ
    Вариант 5: символы ≤, ≥, ≠, ≈, ≅
========================================================

1. Загрузка эталонных образов из patterns/...
   Загружено 15 обучающих образов

Эталонные образы (6x6):
------------------------
Класс ≤ (LE):
  □ □ □ □ ■ ■ 
  □ □ □ ■ ■ □ 
  □ □ ■ ■ □ □ 
  □ □ ■ ■ □ □ 
  □ □ □ ■ ■ □ 
  ■ ■ ■ ■ ■ ■ 

3. Обучение сети...
  Обучение завершено на итерации 23 (макс. расстояние: 0.0089)

4. Определение соответствия нейронов классам:
----------------------------------------------
Класс ≤ → Нейрон-победитель: #0
Класс ≥ → Нейрон-победитель: #1
Класс ≠ → Нейрон-победитель: #2
Класс ≈ → Нейрон-победитель: #3
Класс ≅ → Нейрон-победитель: #4

8. Тестирование на зашумленных образах:
=======================================
┌────────┬───────┬──────────────┬──────────────┐
│ Класс  │  Шум  │  Правильно   │  Неправильно  │
├────────┼───────┼──────────────┼──────────────┤
│   ≤    │   10  │     10/10    │       0/10    │
│   ≤    │   20  │      9/10    │       1/10    │
│   ≤    │   30  │      8/10    │       2/10    │
│   ≤    │   40  │      7/10    │       3/10    │
│   ≤    │   50  │      5/10    │       5/10    │
...
└────────┴───────┴──────────────┴──────────────┘
```

## Параметры сети

| Параметр | Значение |
|----------|----------|
| Входные нейроны | 36 (6×6) |
| Конкурентные нейроны | 5 |
| Скорость обучения β | 0.1 |
| Макс. расстояние | 0.01 |
| Обучающих образов | 15 (по 3 на класс) |

## Результаты тестирования

| Уровень шума | Точность распознавания |
|--------------|------------------------|
| 10%          | 100%                   |
| 20%          | 90%                    |
| 30%          | 80%                    |
| 40%          | 64%                    |
| 50%          | 52%                    |

## Сравнение с другими сетями

| Характеристика | MLP | RBF | Конкурентная |
|----------------|-----|-----|--------------|
| Тип обучения | С учителем | С учителем | Без учителя |
| Скорость обучения | Медленная | Быстрая | Быстрая |
| Назначение | Классификация | Классификация | Кластеризация |

## Выводы

1. Конкурентная сеть успешно кластеризует образы без учителя
2. Частотно-зависимое обучение предотвращает проблему "мертвых нейронов"
3. При шуме до 20% — 90% успешное распознавание
4. Подходит для задач кластеризации без предварительной разметки
