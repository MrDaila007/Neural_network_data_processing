# Лабораторная работа №3
## Сеть РБФ (Радиальная Базисная Функция)

### 1. Цель работы

Изучение топологии, алгоритма функционирования сети РБФ.

### 2. Теоретические сведения

Сеть РБФ (радиальная базисная функция) является аналогом многослойного персептрона. Скорость обучения такой сети гораздо выше, причем допускается полностью аналитический подход к расчету весовых коэффициентов. Однако эти положительные моменты сопровождаются рядом недостатков, главным из которых является ухудшение точности аппроксимации. Сеть обладает хорошей обобщающей способностью только для ограниченного класса аппроксимируемых функций. В качестве классификатора такая сеть может с успехом применяться в случае хорошей кластеризации классов в пространстве признаков.

#### Топология сети РБФ

Упрощение работы и обучения достигается за счет введения вместо скрытого слоя нейронов **слоя РБФ ячеек**.

```
    Входной слой       РБФ слой          Выходной слой
    (распределит.)    (скрытый)         (суммирующий)
    
         x₁ ──────────────┐                    
          │               │     ┌───┐          
          │       ┌───────┼────►│φ₁ │──┬─────┐ 
          │       │       │     └───┘  │     │     ┌───┐
          │       │       │            │     └────►│ Σ │───► y₁
          │       │       │     ┌───┐  │     ┌────►│   │
         x₂ ──────┼───────┼────►│φ₂ │──┼─────┤     └───┘
          │       │       │     └───┘  │     │
          │       │       │            │     │     ┌───┐
         ...     ...     ...    ...   ...   ...───►│ Σ │───► y₂
          │       │       │            │     │     └───┘
          │       │       │     ┌───┐  │     │
         xₙ ──────┴───────┴────►│φₕ │──┴─────┘      ...
                                └───┘          
                                               
                                                   ┌───┐
                  tⱼ (центры)   wⱼₖ (веса)    ───►│ Σ │───► yₘ
                  σⱼ (разброс)                     └───┘
    
    Рис. 4.1. Топология сети РБФ
```

#### Функция РБФ ячейки

Классический закон, по которому РБФ ячейка функционирует, определяется формулой **гауссового колокола**:

```
              ⎛  ‖x - tⱼ‖² ⎞
gⱼ = exp ⎜ - ─────────── ⎟
              ⎝     σⱼ²    ⎠
```

где:
- `x` – входной вектор
- `tⱼ` – вектор, определяющий **математическое ожидание** (центр кластера в пространстве признаков) РБФ ячейки
- `σⱼ` – **среднеквадратическое отклонение** или параметр, зависящий от величины разброса образов класса от его центра

**Евклидово расстояние** между векторами x и tⱼ вычисляется как:

```
‖x - tⱼ‖² = (x₁ - t₁ⱼ)² + (x₂ - t₂ⱼ)² + ... + (xₙ - tₙⱼ)²
```

#### Визуализация функций РБФ ячеек

```
    g(x)
    │
 1.0┤    ╱╲  σ = 2 (узкий)
    │   ╱  ╲
    │  ╱    ╲
 0.5┤ ╱      ╲
    │╱   ╱────╲──── σ = 5 (широкий)
    │   ╱      ╲
    │  ╱        ╲
 0.0┼─────●─────────────► x
         10
       (центр tⱼ)
    
    Рис. 4.2. Примеры функций РБФ ячеек
    с одинаковым центром и разным σ
```

Чем меньше σ, тем **уже** гауссов колокол и тем более **локальной** является реакция ячейки на входные данные.

#### Обучение РБФ ячеек

РБФ ячейки обучаются путем подбора **центра** и **отклонения** каждой из них.

**Выбор центров:**
- Для классификатора в качестве центра выбирается **центр кластера** в пространстве признаков, компактно содержащего образы одного и того же класса
- В простейшем случае, если класс задается одним идеальным образом, этот образ и будет являться вектором `tⱼ` – центром РБФ ячейки

**Выбор параметра разброса σⱼ:**
- Выбирается в зависимости от величины **радиуса кластера** или **расстояния до соседних центров**
- **Рекомендация:** выбирать `σⱼ` как **половину расстояния** до ближайшего центра ячейки, соответствующей другому классу

```
          σ₁ = d₁₂ / 2
    ┌─────────────────────────────┐
    │                             │
    │     ○ t₁        ○ t₂        │
    │    ╱│╲         ╱│╲          │
    │   ╱ │ ╲       ╱ │ ╲         │
    │  ╱  │  ╲     ╱  │  ╲        │
    │─────┼────────────┼──────────│
    │     │←───d₁₂────→│          │
    │                             │
    └─────────────────────────────┘
    
    d₁₂ — расстояние между центрами классов
```

**Количество РБФ ячеек** выбирается таким образом, чтобы **покрыть гауссовыми колоколами все классы**.

#### Выходной слой

Выходной слой РБФ сети обычно состоит из **суммирующих ячеек**:

```
      h
yₖ = ∑ wⱼₖ × gⱼ
     j=1
```

Это позволяет при определенных условиях использовать **систему линейных уравнений** для определения весов выходного слоя. В других обстоятельствах можно использовать **алгоритм градиентного спуска** для настройки весов выходного слоя (функция активации в данном случае линейная).

#### Обучение выходного слоя

С учетом того, что обучается только выходной слой нейронной сети, а скрытый уже настроен, обучение такой сети проходит **на порядок быстрее**, чем аналогичного многослойного персептрона.

В случае обучения выходного слоя по алгоритму градиентного спуска формулы значительно **упрощаются**:

**Коррекция весов:**
```
wⱼₖ := wⱼₖ + α × dₖ × gⱼ
```

где:
- `dₖ = yₖʳ - yₖ` – ошибка k-го нейрона
- `α` – скорость обучения

Поскольку функция активации в выходном слое сети РБФ **линейная** и ее производная равна 1, формула упрощается по сравнению с многослойным персептроном.

Контроль завершения алгоритма обучения производится аналогично многослойному персептрону.

#### Воспроизведение

Сеть функционирует по формулам:

**РБФ слой:**
```
              ⎛  ‖x - tⱼ‖² ⎞
gⱼ = exp ⎜ - ─────────── ⎟
              ⎝     σⱼ²    ⎠
```

**Выходной слой:**
```
      h
yₖ = ∑ wⱼₖ × gⱼ
     j=1
```

#### Ограничения сети РБФ

Функция на выходе РБФ сети будет представлять собой **суперпозицию гауссовых колоколов**. В этом заключается ограничение данного класса классификаторов.

```
    y(x)
    │
    │      ╱╲      ╱╲
    │     ╱  ╲    ╱  ╲   ← Результат суперпозиции
    │    ╱    ╲  ╱    ╲
    │   ╱      ╲╱      ╲
    │  ╱                ╲
    │ ╱                  ╲
    └─────────────────────────► x
         t₁      t₂
```

**Проблемы при неудачном выборе признаков:**
- Выбор количества РБФ ячеек
- Определение центров ячеек
- Определение отклонений

**Компромисс:**
- С **уменьшением** числа РБФ ячеек **улучшается обобщение** данных сетью
- Но могут проявляться **большие ошибки** в эталонных точках

### 3. Задание

1. Ознакомьтесь с теоретической частью.
2. Написать программу на С, С++, реализующую сеть РБФ.
3. Произведите обучение сети РБФ. Исходные данные - 5 классов образов, размер идеального образа 6×6 (в соответствии с вариантом).
4. Подайте на вход сети ряд тестовых образов, по 3 зашумленных образа каждого из 5 классов.
5. Проанализируйте результаты работы программы, которые должны иметь следующий вид:
   - вывести распознаваемый зашумленный образ
   - вывести процент подобия распознаваемого зашумленного образа по отношению к каждому из 5 классов
   - вывести количество шагов, затраченных на обучение сети на заданное количество классов
6. Напишите отчет.

**Пример вывода результатов:**

```
┌─────────────────────────────────────────────────┐
│ Распознаваемый образ (6×6):                     │
│                                                 │
│   ■ □ □ □ □ ■                                   │
│   ■ □ ■ ■ □ ■                                   │
│   ■ □ □ □ □ ■                                   │
│   ■ ■ ■ ■ □ ■                                   │
│   ■ ■ ■ ■ □ ■                                   │
│   ■ □ □ □ □ ■                                   │
│                                                 │
├─────────────────────────────────────────────────┤
│ Процент подобия (выход РБФ):                    │
│   Класс 1 (2): 3.2%                             │
│   Класс 2 (3): 88.7%  ◄── Распознан как "3"     │
│   Класс 3 (4): 5.1%                             │
│   Класс 4 (5): 2.4%                             │
│   Класс 5 (7): 0.6%                             │
│                                                 │
├─────────────────────────────────────────────────┤
│ Шагов обучения: 87                              │
└─────────────────────────────────────────────────┘
```

#### Содержание отчета:

- топология сети РБФ;
- основные формулы обучения и воспроизведения;
- идеальные образы для обучения сети РБФ;
- тестовые зашумленные образы;
- результаты воспроизведения: процент подобия по отношению к каждому из классов, количество шагов, затраченных на обучение;
- результаты сравнения сети РБФ с многослойным персептроном;
- выводы: преимущества и недостатки сети РБФ.

#### Сравнение с многослойным персептроном

| Характеристика | Многослойный персептрон | Сеть РБФ |
|----------------|-------------------------|----------|
| Скорость обучения | Медленная | Быстрая |
| Количество слоев для обучения | 2 (скрытый + выходной) | 1 (только выходной) |
| Точность аппроксимации | Высокая | Ограниченная |
| Универсальность | Широкий класс задач | Хорошо кластеризуемые классы |
| Подбор параметров | Веса, пороги, скорость обучения | Центры, σ, веса выходного слоя |

#### Варианты задания

| № варианта | 1-ый класс | 2-ой класс | 3-ий класс | 4-ый класс | 5-ый класс |
|------------|------------|------------|------------|------------|------------|
| 1          | 2          | 3          | 4          | 5          | 7          |
| 2          | N          | F          | I          | P          | D          |
| 3          | ∧          | ∨          | ∃          | ⊂          | ⊃          |
| 4          | ×          | ÷          | ×          | ÷          | ±          |
| 5          | ≤          | ≥          | ≠          | ≈          | ≅          |
| 6          | L          | U          | T          | O          | K          |
| 7          | →          | ←          | ↔          | ⇔          | ⇐          |

### 4. Контрольные вопросы

1. Топология сети РБФ.
2. Обучение сети, выбор количества РБФ ячеек.
3. Процесс воспроизведения информации в сети РБФ.
4. Каким образом можно улучшить работу сети?
5. Достоинства и недостатки данного типа нейронной сети.
