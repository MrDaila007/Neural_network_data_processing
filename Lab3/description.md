# Лабораторная работа №3
## Сеть РБФ (Радиальная Базисная Функция)

### 1. Цель работы

Изучение топологии, алгоритма функционирования сети РБФ.

### 2. Теоретические сведения

Сеть РБФ (радиальная базисная функция) является аналогом многослойного персептрона. Скорость обучения такой сети гораздо выше, причем допускается полностью аналитический подход к расчету весовых коэффициентов. Однако эти положительные моменты сопровождаются рядом недостатков, главным из которых является ухудшение точности аппроксимации. Сеть обладает хорошей обобщающей способностью только для ограниченного класса аппроксимируемых функций. В качестве классификатора такая сеть может с успехом применяться в случае хорошей кластеризации классов в пространстве признаков.

#### Топология сети РБФ

Упрощение работы и обучения достигается за счет введения вместо скрытого слоя нейронов слоя РБФ ячеек. Классический закон, по которому такая ячейка функционирует, определяется формулой гауссового колокола:

```
g_j = exp(-||x - t_j||^2 / σ_j^2)
```

где:
- `x` – входной вектор
- `t_j` – вектор, определяющий математическое ожидание (центр кластера в пространстве признаков) РБФ ячейки
- `σ_j` – среднеквадратическое отклонение или параметр, зависящий от величины разброса образов класса от его центра

Евклидово расстояние между векторами x и t_j вычисляется как:

```
||x - t_j||^2 = (x_1 - t_1j)^2 + (x_2 - t_2j)^2 + ... + (x_n - t_nj)^2
```

#### Обучение

РБФ ячейки обучаются путем подбора центра и отклонения каждой из них. Для классификатора в качестве центра выбирается центр кластера в пространстве признаков, компактно содержащего образы одного и того же класса. В простейшем случае, если класс задается одним идеальным образом, этот образ и будет являться вектором `t` – центром РБФ ячейки.

Параметр разброса каждой ячейки выбирается в зависимости от величины радиуса кластера или расстояния до соседних центров. Рекомендуется выбирать `σ` как половину расстояния до ближайшего центра ячейки, соответствующей другому классу.

Количество РБФ ячеек выбирается таким образом, чтобы покрыть гауссовыми колоколами все классы.

#### Выходной слой

Выходной слой РБФ сети обычно состоит из суммирующих ячеек:

```
y_k = ∑ w_jk * g_j
      j=1
```

Это позволяет при определенных условиях использовать систему линейных уравнений для определения весов выходного слоя. В других обстоятельствах можно использовать алгоритм градиентного спуска для настройки весов выходного слоя (функция активации в данном случае линейная).

#### Обучение выходного слоя

В случае обучения выходного слоя по алгоритму градиентного спуска формулы значительно упрощаются. Формула коррекции весов:

```
w_jk(t+1) = w_jk(t) + α * d_k * g_j
```

где:
- `d_k = y_k^r - y_k` – ошибка k-го нейрона
- `α` – скорость обучения

Поскольку функция активации в выходном слое сети РБФ линейная и ее производная равна 1, формула упрощается по сравнению с многослойным персептроном.

Контроль завершения алгоритма обучения производится аналогично многослойному персептрону.

#### Воспроизведение

Сеть функционирует по формулам:

```
g_j = exp(-||x - t_j||^2 / σ_j^2)
y_k = ∑ w_jk * g_j
      j=1
```

Функция на выходе РБФ сети будет представлять собой суперпозицию гауссовых колоколов. При неудачном выборе признаков большой проблемой является выбор количества РБФ ячеек, определение их центров и отклонения. С уменьшением числа РБФ ячеек улучшается обобщение данных сетью, но могут проявляться большие ошибки в эталонных точках.

### 3. Задание

1. Ознакомьтесь с теоретической частью.
2. Написать программу на С, С++, реализующую сеть РБФ.
3. Произведите обучение сети РБФ. Исходные данные - 5 классов образов, размер идеального образа 6×6 (в соответствии с вариантом).
4. Подайте на вход сети ряд тестовых образов, по 3 зашумленных образа каждого из 5 классов.
5. Проанализируйте результаты работы программы, которые должны иметь следующий вид:
   - вывести распознаваемый зашумленный образ
   - вывести процент подобия распознаваемого зашумленного образа по отношению к каждому из 5 классов
   - вывести количество шагов, затраченных на обучение сети на заданное количество классов
6. Напишите отчет.

#### Содержание отчета:

- топология сети РБФ;
- основные формулы обучения и воспроизведения;
- идеальные образы для обучения сети РБФ;
- тестовые зашумленные образы;
- результаты воспроизведения: процент подобия по отношению к каждому из классов, количество шагов, затраченных на обучение;
- результаты сравнения сети РБФ с многослойным персептроном;
- выводы: преимущества и недостатки сети РБФ.

#### Варианты задания

| № варианта | 1-ый класс | 2-ой класс | 3-ий класс | 4-ый класс | 5-ый класс |
|------------|------------|------------|------------|------------|------------|
| 1          | 2          | 3          | 4          | 5          | 7          |
| 2          | N          | F          | I          | P          | D          |
| 3          | ∧          | ∨          | ∃          | ⊂          | ⊃          |
| 4          | ×          | ÷          | ×          | ÷          | ±          |
| 5          | ≤          | ≥          | ≠          | ≈          | ≅          |
| 6          | L          | U          | T          | O          | K          |
| 7          | →          | ←          | ↔          | ⇔          | ⇐          |

### 4. Контрольные вопросы

1. Топология сети РБФ.
2. Обучение сети, выбор количества РБФ ячеек.
3. Процесс воспроизведения информации в сети РБФ.
4. Каким образом можно улучшить работу сети?
5. Достоинства и недостатки данного типа нейронной сети.
