# Лабораторная работа №3: Сеть РБФ (Радиальная Базисная Функция)

## Цель работы

Изучение топологии и алгоритма функционирования сети РБФ. Реализация программы для распознавания зашумленных образов.

## Теоретические сведения

Сеть РБФ — аналог многослойного персептрона со значительно более высокой скоростью обучения. Вместо скрытого слоя нейронов используется слой РБФ-ячеек с гауссовой функцией активации.

### Архитектура сети

```
    Входной слой       РБФ слой          Выходной слой
    (36 нейронов)    (5 ячеек)         (5 нейронов)
    
         x₁ ──────────────┐                    
          │               │     ┌───┐          
          │       ┌───────┼────►│φ₁ │──┬─────► y₁ (N)
          │       │       │     └───┘  │       
          │       │       │            │       
         x₂ ──────┼───────┼────►┌───┐  │       
          │       │       │    │φ₂ │──┼─────► y₂ (F)
          │       │       │     └───┘  │       
          │       │       │            │       
         ...     ...     ...    ...   ...      
          │       │       │            │       
          │       │       │     ┌───┐  │       
         x₃₆─────┴───────┴────►│φ₅ │──┴─────► y₅ (D)
                               └───┘          
                                              
                    Гауссов колокол:          
                 exp(-||x-t||²/σ²)            
```

### Основные формулы

**РБФ-ячейка (гауссов колокол):**
```
g_j = exp(-||x - t_j||² / σ_j²)
```

где:
- `x` — входной вектор
- `t_j` — центр РБФ-ячейки (эталонный образ)
- `σ_j` — параметр разброса (половина расстояния до ближайшего центра)

**Выходной слой (линейная комбинация):**
```
y_k = Σ(j=1 to h) w_jk × g_j
```

**Обучение выходного слоя:**
```
w_jk := w_jk + α × d_k × g_j
```

## Вариант задания

**Вариант 2:** Классы **N**, **F**, **I**, **P**, **D** (размер 6×6)

### Эталонные образы

```
Класс N (6×6):        Класс F (6×6):        Класс I (6×6):
■ □ □ □ □ ■          ■ ■ ■ ■ ■ ■          ■ ■ ■ ■ ■ ■
■ ■ □ □ □ ■          ■ □ □ □ □ □          □ □ ■ ■ □ □
■ □ ■ □ □ ■          ■ □ □ □ □ □          □ □ ■ ■ □ □
■ □ □ ■ □ ■          ■ ■ ■ ■ □ □          □ □ ■ ■ □ □
■ □ □ □ ■ ■          ■ □ □ □ □ □          □ □ ■ ■ □ □
■ □ □ □ □ ■          ■ □ □ □ □ □          ■ ■ ■ ■ ■ ■

Класс P (6×6):        Класс D (6×6):
■ ■ ■ ■ □ □          ■ ■ ■ ■ □ □
■ □ □ □ ■ □          ■ □ □ □ ■ □
■ □ □ □ ■ □          ■ □ □ □ ■ □
■ ■ ■ ■ □ □          ■ □ □ □ ■ □
■ □ □ □ □ □          ■ □ □ □ ■ □
■ □ □ □ □ □          ■ ■ ■ ■ □ □
```

## Сборка и запуск

### Требования

- Компилятор C++ с поддержкой C++17 (g++ 8+, clang++ 7+)
- Стандартная библиотека C++ (filesystem)

### Компиляция

```bash
cd Lab3
g++ -std=c++17 solution.cpp -o solution
```

### Запуск

```bash
./solution
```

## Структура файлов

```
Lab3/
├── README.md           # Этот файл
├── description.md      # Подробное описание задания
├── solution.cpp        # Исходный код решения
├── solution            # Скомпилированная программа
├── report.tex          # Отчет в формате LaTeX
├── report.pdf          # Скомпилированный отчет
├── patterns/           # Эталонные образы
│   ├── N.txt           # Класс N
│   ├── F.txt           # Класс F
│   ├── I.txt           # Класс I
│   ├── P.txt           # Класс P
│   └── D.txt           # Класс D
└── tests/              # Тестовые образы с шумом
    ├── N/
    ├── F/
    ├── I/
    ├── P/
    └── D/
```

## Пример вывода программы

```
========================================================
    ЛАБОРАТОРНАЯ РАБОТА №3: СЕТЬ РБФ
    Вариант 2: классы N, F, I, P, D
========================================================

1. Загрузка эталонных образов из patterns/...

Идеальные образы для обучения (6x6):
-----------------------------------
Класс 1 (N):
  ■ □ □ □ □ ■ 
  ■ ■ □ □ □ ■ 
  ■ □ ■ □ □ ■ 
  ■ □ □ ■ □ ■ 
  ■ □ □ □ ■ ■ 
  ■ □ □ □ □ ■ 

2. Инициализация РБФ ячеек...
   Количество РБФ ячеек: 5
   Класс 1 (N): sigma = 3.742
   Класс 2 (F): sigma = 3.464
   ...

3. Обучение выходного слоя градиентным спуском...
   Обучение завершено за 87 шагов

4. Тестирование распознавания:
┌─────────────────────────────────────────────────┐
│ Распознаваемый образ (6×6):                     │
│   ■ □ □ □ □ ■                                   │
│   ■ ■ □ □ □ ■                                   │
│   ...                                           │
├─────────────────────────────────────────────────┤
│ Процент подобия (выход РБФ):                    │
│   Класс 1 (N): 85.2%  ◄── Распознан как "N"     │
│   Класс 2 (F): 3.1%                             │
│   Класс 3 (I): 5.4%                             │
│   Класс 4 (P): 4.8%                             │
│   Класс 5 (D): 1.5%                             │
├─────────────────────────────────────────────────┤
│ Шагов обучения: 87                              │
└─────────────────────────────────────────────────┘
```

## Параметры сети

| Параметр | Значение |
|----------|----------|
| Входной слой | 36 нейронов |
| РБФ-ячейки | 5 (по одной на класс) |
| Выходной слой | 5 нейронов |
| Скорость обучения | 0.1 |
| Точность | 1e-6 |

## Сравнение с многослойным персептроном

| Характеристика | MLP | Сеть РБФ |
|----------------|-----|----------|
| Скорость обучения | Медленная (1000+ эпох) | Быстрая (~100 шагов) |
| Слоев для обучения | 2 (скрытый + выходной) | 1 (только выходной) |
| Точность аппроксимации | Высокая | Ограниченная |
| Универсальность | Широкий класс задач | Хорошо кластеризуемые классы |
| Функция активации | Сигмоида | Гауссов колокол |

## Преимущества

- **Быстрое обучение:** обучается только выходной слой
- **Простота:** центры РБФ-ячеек = эталонные образы
- **Интерпретируемость:** выход показывает "близость" к каждому классу

## Недостатки

- **Ограниченная точность:** хуже аппроксимирует сложные границы классов
- **Требует хорошей кластеризации:** классы должны быть хорошо разделимы
- **Подбор σ:** требуется правильный выбор параметра разброса

## Выводы

1. Сеть РБФ обучается значительно быстрее MLP
2. Хорошо работает для хорошо кластеризуемых классов
3. Центры РБФ-ячеек совпадают с эталонными образами
4. Рекомендуется при необходимости быстрого обучения

## Компиляция отчета

```bash
cd Lab3
xelatex report.tex
```

Требуется XeLaTeX и шрифты DejaVu.

