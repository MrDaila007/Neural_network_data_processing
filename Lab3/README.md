# Лабораторная работа №3: Сеть РБФ (Радиальная Базисная Функция)

## Цель работы

Изучение топологии и алгоритма функционирования сети РБФ. Реализация программы для распознавания зашумленных образов.

## Теоретические сведения

Сеть РБФ — аналог многослойного персептрона с более быстрым обучением. Скрытый слой использует гауссовы функции активации.

### Архитектура сети

```
    Входной слой        РБФ слой            Выходной слой
    (36 входов)         (5 ячеек)           (5 нейронов)
    
    ┌───┐               ┌───────┐           ┌───┐
    │x₁ │──────────────►│ RBF₁  │──────────►│y₁ │ → Класс N
    └───┘               │exp(-d²)│           └───┘
    ┌───┐               └───────┘           ┌───┐
    │x₂ │──────────────►│ RBF₂  │──────────►│y₂ │ → Класс F
    └───┘               │exp(-d²)│           └───┘
      ⋮                    ⋮                   ⋮
    ┌───┐               ┌───────┐           ┌───┐
    │x₃₆│──────────────►│ RBF₅  │──────────►│y₅ │ → Класс D
    └───┘               │exp(-d²)│           └───┘
```

### Основные формулы

**Гауссов колокол (выход РБФ ячейки):**
```
g_j = exp(-||x - t_j||² / σ_j²)
```

**Выходной слой:**
```
y_k = Σ w_jk × g_j
```

**Обучение выходного слоя:**
```
w_jk := w_jk + α × (y_k^target - y_k) × g_j
```

## Вариант задания

**Вариант 2:** Классы **N**, **F**, **I**, **P**, **D** (размер 6×6)

## Требования

- Компилятор C++ с поддержкой C++17 (g++ 8+, clang++ 7+)
- Стандартная библиотека C++ (filesystem)

## Сборка и запуск

### 1. Компиляция

```bash
cd Lab3
g++ -std=c++17 solution.cpp -o solution
```

### 2. Запуск с выводом в консоль

```bash
./solution
```

### 3. Запуск с сохранением вывода в файл

```bash
# Сохранить вывод в файл (без отображения в консоли)
./solution > output.txt

# Сохранить вывод в файл И отобразить в консоли
./solution | tee output.txt

# Сохранить вывод вместе с ошибками
./solution > output.txt 2>&1
```

### 4. Компиляция отчёта LaTeX

```bash
xelatex report.tex
```

Требуется XeLaTeX и шрифты DejaVu.

## Структура файлов

```
Lab3/
├── README.md           # Этот файл
├── description.md      # Подробное описание задания
├── solution.cpp        # Исходный код решения
├── solution            # Скомпилированная программа
├── report.tex          # Отчет в формате LaTeX
├── report.pdf          # Скомпилированный отчет
├── output.txt          # Вывод программы (после запуска)
├── patterns/           # Эталонные образы
│   ├── N.txt           # Буква N
│   ├── F.txt           # Буква F
│   ├── I.txt           # Буква I
│   ├── P.txt           # Буква P
│   └── D.txt           # Буква D
└── tests/              # Тестовые образы с шумом
    ├── N/
    │   ├── noise_10/   # 10% шума
    │   ├── noise_20/   # 20% шума
    │   └── ...
    ├── F/
    ├── I/
    ├── P/
    └── D/
```

## Выходные файлы

После запуска программы создаются:

| Файл | Описание |
|------|----------|
| `tests/*/noise_*/test_*.txt` | Сгенерированные зашумлённые образы |
| `output.txt` | Полный вывод программы (при использовании `> output.txt`) |

## Пример вывода программы

```
========================================================
    ЛАБОРАТОРНАЯ РАБОТА №3: СЕТЬ РБФ
    Вариант 2: классы N, F, I, P, D
========================================================

1. Загрузка эталонных образов из patterns/...

Идеальные образы для обучения (6x6):
-----------------------------------
Класс 1 (N):
  ■ □ □ □ □ ■
  ■ ■ □ □ □ ■
  ...

2. Инициализация РБФ ячеек...
   Количество РБФ ячеек: 5
   Класс 1 (N): sigma = 2.449
   Класс 2 (F): sigma = 2.449
   ...

3. Обучение выходного слоя градиентным спуском...
   Обучение завершено за 87 шагов

┌─────────────────────────────────────────────────┐
│ Распознаваемый образ (6×6):                     │
│   ■ □ □ □ □ ■                                   │
│   ■ ■ □ □ □ ■                                   │
├─────────────────────────────────────────────────┤
│ Процент подобия (выход РБФ):                    │
│   Класс 1 (N): 85.2%  ◄── Распознан как "N"     │
│   Класс 2 (F): 3.1%                             │
│   Класс 3 (I): 5.4%                             │
│   Класс 4 (P): 4.8%                             │
│   Класс 5 (D): 1.5%                             │
└─────────────────────────────────────────────────┘
```

## Параметры сети

| Параметр | Значение |
|----------|----------|
| Входные нейроны | 36 (6×6) |
| РБФ ячеек | 5 (по одной на класс) |
| Выходные нейроны | 5 |
| Скорость обучения α | 0.1 |
| σ (sigma) | Авто (половина расстояния до ближайшего центра) |

## Сравнение с MLP

| Характеристика | MLP | RBF |
|----------------|-----|-----|
| Скорость обучения | Медленная | Быстрая |
| Обучаемые слои | 2 | 1 (только выходной) |
| Точность | Высокая | Ограниченная |

## Выводы

1. Сеть РБФ обучается значительно быстрее MLP (менее 100 шагов)
2. Качество распознавания сопоставимо с MLP при низком шуме
3. Подходит для задач с хорошо кластеризуемыми классами
