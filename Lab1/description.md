# Лабораторная работа №1
## Нейронная сеть Хопфилда

### 1. Цель работы

Изучение топологии, алгоритма функционирования сети Хопфилда.

### 2. Теоретические сведения

Сеть Хопфилда – однослойная, симметричная, нелинейная, автоассоциативная нейронная сеть, которая запоминает бинарные / биполярные образы. Сеть характеризуется наличием обратных связей.

#### Топология сети Хопфилда

Информация с выхода каждого нейрона поступает на вход всех остальных нейронов. Образы для данной модификации сети Хопфилда кодируются биполярным вектором, состоящим из 1 и –1.

```
    ┌─────────────────────────────────────────────┐
    │                                             │
    │   ┌───┐         ┌───┐         ┌───┐        │
    │   │a₁ │◄───────►│a₂ │◄───────►│a₃ │        │
    │   └─┬─┘         └─┬─┘         └─┬─┘        │
    │     │      ╲      │      ╱      │          │
    │     │       ╲     │     ╱       │          │
    │     │        ╲    │    ╱        │          │
    │     │         ╲   │   ╱         │          │
    │     │          ╲  │  ╱          │          │
    │     │           ╲ │ ╱           │          │
    │     ▼            ╲▼╱            ▼          │
    │   ┌───┐         ┌───┐         ┌───┐        │
    │   │...│◄───────►│...│◄───────►│...│        │
    │   └─┬─┘         └─┬─┘         └─┬─┘        │
    │     │             │             │          │
    │     ▼             ▼             ▼          │
    │   ┌───┐         ┌───┐         ┌───┐        │
    │   │aₙ │◄───────►│   │◄───────►│   │        │
    │   └───┘         └───┘         └───┘        │
    │                                             │
    └─────────────────────────────────────────────┘
    
    Рис. 2.1. Топология сети Хопфилда
    (полносвязная сеть с обратными связями)
```

Каждый нейрон связан со всеми остальными нейронами, кроме себя (w_ii = 0).

#### Обучение

Обучение сети осуществляется в соответствии с соотношением:

```
        ⎧  m
        ⎪  ∑ aᵢᵏ × aⱼᵏ, i ≠ j
w_ij = ⎨ k=1
        ⎪
        ⎩  0, i = j

для i, j = 1, n
```

где:
- `w_ij` – вес связи от i-го нейрона к j-му;
- `n` – количество нейронов в сети;
- `m` – количество образов, используемых для обучения сети;
- `aᵢᵏ` – i-й элемент k-го образа из обучающей выборки.

#### Матрица весовых коэффициентов

Матрица весовых коэффициентов W имеет вид:

```
     ┌                           ┐
     │ w₁₁   w₁₂   ...   w₁ₙ    │
     │ w₂₁   w₂₂   ...   w₂ₙ    │
W =  │ ...   ...   ...   ...    │
     │ wₙ₁   wₙ₂   ...   wₙₙ    │
     └                           ┘
```

В качестве матрицы весовых коэффициентов Хопфилд использовал **симметричную матрицу** (w_ij = w_ji) с **нулевой главной диагональю** (w_ii = 0). Последнее условие соответствует отсутствию обратной связи нейронного элемента на себя.

В качестве функции активации нейронных элементов может использоваться как пороговая, так и непрерывная функция, например сигмоидная или гиперболический тангенс.

#### Концепция вычислительной энергии

Для описания функционирования сети Хопфилд использовал аппарат статистической физики. При этом каждый нейрон имеет два состояния активности (1, –1), которые аналогичны значениям спина некоторой частицы.

Хопфилд ввел понятие **вычислительной энергии**, которую можно интерпретировать в виде **ландшафта с долинами и впадинами**:

```
    Энергия E
        │
        │    ╱╲
        │   ╱  ╲      ╱╲
        │  ╱    ╲    ╱  ╲
        │ ╱      ╲  ╱    ╲     ╱
        │╱        ╲╱      ╲   ╱
        │          ▼       ╲ ╱
        │      Локальный    ▼
        │      минимум   Глобальный
        │                минимум
        └────────────────────────────►
                          Состояние
```

- **Структура соединений сети** определяет очертания ландшафта
- Нейронная сеть выполняет вычисления, следуя по пути, **уменьшающему вычислительную энергию** сети
- Процесс продолжается до тех пор, пока путь не приведет на **дно впадины** (аналогия: скатывание капли жидкости по склону)
- **Впадины и долины** соответствуют наборам информации, которую хранит сеть
- Если процесс начинается с приближенной или неполной информации, он следует по пути к **ближайшей впадине** — это соответствует операции ассоциативного распознавания

#### Воспроизведение

Нейронная сеть Хопфилда может функционировать **синхронно** и **асинхронно**. Для воспроизведения используется соотношение:

```
             ⎛  n            ⎞
aᵢ(t+1) = f ⎜  ∑ wᵢⱼ × aⱼ(t)⎟
             ⎝ j=1           ⎠
```

где `aⱼ(t)` – выход j-го нейрона в момент времени t, а `f` – бинарная / биполярная функция активации:

```
       ⎧  1, x > 0,
f(x) = ⎨
       ⎩ -1, x ≤ 0.
```

**Режимы работы:**

| Режим | Описание |
|-------|----------|
| Синхронный | На один такт работы сети все нейроны одновременно меняют состояние |
| Асинхронный | Состояние меняет только один случайный нейрон |

Итерации продолжаются до тех пор, пока сеть не придет в **стабильное состояние**.

Во время воспроизведения исходным вектором a(0) является некоторый тестовый образ, не совпадающий с образами из обучающей выборки. В процессе функционирования сеть должна прийти в состояние, соответствующее образу из обучающей выборки, наиболее похожему на тестовый.

#### Ёмкость сети

Максимальное количество образов, которое можно запомнить в матрице W не превышает:

```
           n
m ≈ ───────────────────
    2 × ln(n) + ln(ln(n))
```

где `n` – количество нейронов.

Это является одним из **недостатков** сети Хопфилда.

### 3. Задание

1. Ознакомьтесь с теоретической частью.
2. На языке С, С++ напишите программу, реализующую нейронную сеть Хопфилда.
3. Произведите обучение сети Хопфилда на заданный тип образов. Для запоминания в соответствии с вариантом задано 3 образа (бинарные изображения размером 10×10).
4. Подайте на вход сети ряд тестовых образов, в которые внесено зашумление (процент зашумления образа – 10%, 20%, 30%, 35%, 40%, 45%, 50%, 60%, 70%, 80%, 90%, 100%). Тестовых образов должно быть не менее 10 для каждого из классов с одним и тем же процентом зашумления.
5. Проанализируйте результаты, при каком проценте зашумления тестовые образы распознаются верно.
6. Напишите отчет.

#### Пример зашумления образа

Таблица 2.2 — Пример задания тестируемого и искаженных образов (буква "А")

| Тестируемый образ | Зашумление | Вид искаженного образа |
|-------------------|------------|------------------------|
| ![A](../Doc/PDF%20JPG/) | 10% | Случайная инверсия 10% пикселей |
| | 20% | Случайная инверсия 20% пикселей |
| | 30% | Случайная инверсия 30% пикселей |
| | 35% | Случайная инверсия 35% пикселей |
| | 40% | Случайная инверсия 40% пикселей |
| | 45% | Случайная инверсия 45% пикселей |
| | 50% | Случайная инверсия 50% пикселей |
| | 60% | Случайная инверсия 60% пикселей |
| | 70% | Случайная инверсия 70% пикселей |
| | 80% | Случайная инверсия 80% пикселей |
| | 90% | Случайная инверсия 90% пикселей |
| | 100% | Полная инверсия всех пикселей |

**Пример визуализации зашумления (образ 10×10):**

```
Оригинал "А":     10% шума:        30% шума:        50% шума:
■ ■ ■ ■ ■ ■ ■ ■    ■ ■ ■ ■ ■ ■ ■ ■   ■ □ ■ ■ ■ ■ ■ □   □ ■ ■ □ ■ ■ □ ■
■ ■ ■ ■ ■ ■ ■ ■    ■ ■ ■ ■ ■ ■ □ ■   ■ ■ □ ■ ■ ■ ■ ■   ■ □ ■ ■ □ ■ ■ ■
■ ■ ■ □ □ ■ ■ ■    ■ ■ ■ □ □ ■ ■ ■   □ ■ ■ □ □ ■ ■ □   ■ ■ □ □ ■ ■ ■ □
■ ■ □ ■ ■ □ ■ ■    ■ ■ □ ■ ■ □ ■ ■   ■ ■ □ ■ ■ ■ ■ ■   □ ■ □ ■ □ □ ■ ■
■ ■ □ ■ ■ □ ■ ■    ■ ■ □ ■ □ □ ■ ■   ■ □ □ ■ ■ □ □ ■   ■ ■ □ □ ■ □ □ ■
■ □ □ □ □ □ □ ■    ■ □ □ □ □ □ □ ■   ■ □ ■ □ □ □ □ ■   ■ □ ■ □ ■ □ □ □
■ □ ■ ■ ■ ■ □ ■    ■ □ ■ ■ ■ ■ □ ■   ■ □ ■ ■ □ ■ □ ■   □ □ ■ ■ □ ■ □ ■
■ □ ■ ■ ■ ■ □ ■    ■ □ ■ ■ ■ ■ □ ■   □ □ ■ ■ ■ □ □ ■   ■ ■ ■ □ ■ ■ □ □

(■ = 1, □ = -1)
```

#### Содержание отчета:

- топология сети Хопфилда;
- описание алгоритма работы сети;
- тестируемые образы (3 образа);
- искаженные образы (процент зашумления образа – 10%, 20%, 30%, 35%, 40%, 45%, 50%, 60%, 70%, 80%, 90%, 100%);
- результаты распознавания, статистика;
- выводы.

#### Варианты задания

| № варианта | 1-ый тестируемый образ | 2-ой тестируемый образ | 3-ий тестируемый образ |
|------------|------------------------|------------------------|------------------------|
| 1          | «А»                    | «И»                    | «Р»                    |
| 2          | «Б»                    | «К»                    | «С»                    |
| 3          | «В»                    | «Л»                    | «Т»                    |
| 4          | «Г»                    | «М»                    | «У»                    |
| 5          | «Д»                    | «Н»                    | «Х»                    |
| 6          | «Е»                    | «О»                    | «Ш»                    |
| 7          | «З»                    | «П»                    | «Ь»                    |

### 4. Контрольные вопросы

1. Топология сети Хопфилда.
2. Обучение сети Хопфилда.
3. Процесс воспроизведения информации в сети Хопфилда.
4. Зависимость максимального количества образов, запоминаемых сетью, от ее размера.
5. В чем причина некорректной работы при запоминании подобных образов?
6. Варианты использования сети Хопфилда.
